!function(t){function e(t,e,n,a){if(t.tag.format&&n.length>0){n.push("\n");for(var i=0;a>i;i++)n.push("	")}}function n(a,i){var r=[],s=0==a.attributes.length,l=0;if(a.tag.isComment)i.allowComments&&(r.push("<!--"),r.push(a.tag.rawAttributes),r.push(">"),i.format&&e(a,i,r,l-1));else{var h=a.tag.render&&(0==i.allowedTags.length||t.inArray(a.tag.name,i.allowedTags)>-1)&&(0==i.removeTags.length||-1==t.inArray(a.tag.name,i.removeTags));if(!a.isRoot&&h&&(r.push("<"),r.push(a.tag.name),t.each(a.attributes,function(){if(-1==t.inArray(this.name,i.removeAttrs)){var e=RegExp(/^(['"]?)(.*?)['"]?$/).exec(this.value),n=e[2],s=e[1]||"'";"class"==this.name&&i.allowedClasses.length>0&&(n=t.grep(n.split(" "),function(e){return t.grep(i.allowedClasses,function(n){return n==e||n[0]==e&&(1==n.length||t.inArray(a.tag.name,n[1])>-1)}).length>0}).join(" ")),null!=n&&(n.length>0||t.inArray(this.name,a.tag.requiredAttributes)>-1)&&(r.push(" "),r.push(this.name),r.push("="),r.push(s),r.push(n),r.push(s))}})),a.tag.isSelfClosing)h&&r.push(" />"),s=!1;else if(a.tag.isNonClosing)s=!1;else{if(!a.isRoot&&h&&r.push(">"),l=i.formatIndent++,a.tag.toProtect)d=t.htmlClean.trim(a.children.join("")).replace(/<br>/gi,"\n"),r.push(d),s=0==d.length;else{for(var d=[],p=0;p<a.children.length;p++){var f=a.children[p],b=t.htmlClean.trim(g(u(f)?f:f.childrenToString()));m(f)&&p>0&&b.length>0&&(o(f)||c(a.children[p-1]))&&d.push(" "),u(f)?b.length>0&&d.push(b):(p!=a.children.length-1||"br"!=f.tag.name)&&(i.format&&e(f,i,d,l),d=d.concat(n(f,i)))}i.formatIndent--,d.length>0&&(i.format&&"\n"!=d[0]&&e(a,i,r,l),r=r.concat(d),s=!1)}!a.isRoot&&h&&(i.format&&e(a,i,r,l-1),r.push("</"),r.push(a.tag.name),r.push(">"))}if(!a.tag.allowEmpty&&s)return[]}return r}function a(e,n){return r(e,function(e){return t.inArray(e.tag.nameOriginal,n)>-1})}function i(t){return r(t,function(t){return t.isRoot||!t.tag.isInline})}function r(t,e,n){n=n||1;var a=t[t.length-n];return e(a)?!0:t.length-n>0&&r(t,e,n+1)?(t.pop(),!0):!1}function s(t){return t?(this.tag=t,this.isRoot=!1):(this.tag=new h("root"),this.isRoot=!0),this.attributes=[],this.children=[],this.hasAttribute=function(t){for(var e=0;e<this.attributes.length;e++)if(this.attributes[e].name==t)return!0;return!1},this.childrenToString=function(){return this.children.join("")},this}function l(t,e){return this.name=t,this.value=e,this}function h(e,n,a,i){return this.name=e.toLowerCase(),this.nameOriginal=this.name,this.render=!0,this.init=function(){if("--"==this.name?(this.isComment=!0,this.isSelfClosing=!0,this.format=!0):(this.isComment=!1,this.isSelfClosing=t.inArray(this.name,C)>-1,this.isNonClosing=t.inArray(this.name,v)>-1,this.isClosing=void 0!=n&&n.length>0,this.isInline=t.inArray(this.name,p)>-1,this.disallowNest=t.inArray(this.name,b)>-1,this.requiredParent=w[t.inArray(this.name,w)+1],this.allowEmpty=i&&t.inArray(this.name,i.allowEmpty)>-1,this.toProtect=t.inArray(this.name,A)>-1,this.format=t.inArray(this.name,f)>-1||!this.isInline),this.rawAttributes=a,this.requiredAttributes=S[t.inArray(this.name,S)+1],i){if(i.tagAttributesCache||(i.tagAttributesCache=[]),-1==t.inArray(this.name,i.tagAttributesCache)){for(var e=x[t.inArray(this.name,x)+1].slice(0),r=0;r<i.allowedAttributes.length;r++){var s=i.allowedAttributes[r][0];(1==i.allowedAttributes[r].length||t.inArray(this.name,i.allowedAttributes[r][1])>-1)&&-1==t.inArray(s,e)&&e.push(s)}i.tagAttributesCache.push(this.name),i.tagAttributesCache.push(e)}this.allowedAttributes=i.tagAttributesCache[t.inArray(this.name,i.tagAttributesCache)+1]}},this.init(),this.rename=function(t){this.name=t,this.init()},this}function o(e){for(;d(e)&&e.children.length>0;)e=e.children[0];if(!u(e))return!1;var n=g(e);return n.length>0&&t.htmlClean.isWhitespace(n.charAt(0))}function c(e){for(;d(e)&&e.children.length>0;)e=e.children[e.children.length-1];if(!u(e))return!1;var n=g(e);return n.length>0&&t.htmlClean.isWhitespace(n.charAt(n.length-1))}function u(t){return t.constructor==String}function m(t){return u(t)||t.tag.isInline}function d(t){return t.constructor==s}function g(t){return t.replace(/&nbsp;|\n/g," ").replace(/\s\s+/g," ")}t.fn.htmlClean=function(e){return this.each(function(){this.value?this.value=t.htmlClean(this.value,e):this.innerHTML=t.htmlClean(this.innerHTML,e)})},t.htmlClean=function(e,r){r=t.extend({},t.htmlClean.defaults,r),r.allowEmpty=y.concat(r.allowEmpty);var o,c=/(<(\/)?(\w+:)?([\w]+)([^>]*)>)|<!--(.*?--)>/gi,m=/([\w\-]+)\s*=\s*(".*?"|'.*?'|[^\s>\/]*)/gi,d=new s,g=[d],p=d;r.bodyOnly&&(o=/<body[^>]*>((\n|.)*)<\/body>/i.exec(e))&&(e=o[1]),e=e.concat("<xxx>");for(var f;o=c.exec(e);){var b=o[6]?new h("--",null,o[6],r):new h(o[4],o[2],o[5],r),w=e.substring(f,o.index);if(w.length>0){var A=p.children[p.children.length-1];p.children.length>0&&u(A=p.children[p.children.length-1])?p.children[p.children.length-1]=A.concat(w):p.children.push(w)}if(f=c.lastIndex,b.isClosing)a(g,[b.name])&&(g.pop(),p=g[g.length-1]);else{for(var C,v=new s(b);C=m.exec(b.rawAttributes);){if("style"==C[1].toLowerCase()&&r.replaceStyles)for(var x=!b.isInline,S=0;S<r.replaceStyles.length;S++)r.replaceStyles[S][0].test(C[2])&&(x||(b.render=!1,x=!0),p.children.push(v),g.push(v),p=v,b=new h(r.replaceStyles[S][1],"","",r),v=new s(b));null!=b.allowedAttributes&&(0==b.allowedAttributes.length||t.inArray(C[1],b.allowedAttributes)>-1)&&v.attributes.push(new l(C[1],C[2]))}t.each(b.requiredAttributes,function(){var t=this.toString();v.hasAttribute(t)||v.attributes.push(new l(t,""))});for(var I=0;I<r.replace.length;I++)for(var k=0;k<r.replace[I][0].length;k++){var E="string"==typeof r.replace[I][0][k];if(E&&r.replace[I][0][k]==b.name||!E&&r.replace[I][0][k].test(o)){b.rename(r.replace[I][1]),I=r.replace.length;break}}var q=!0;if(p.isRoot||(p.tag.isInline&&!b.isInline?(q=i(g))&&(p=g[g.length-1]):p.tag.disallowNest&&b.disallowNest&&!b.requiredParent?q=!1:b.requiredParent&&(q=a(g,b.requiredParent))&&(p=g[g.length-1])),q)if(p.children.push(v),b.toProtect)for(var T;T=c.exec(e);){var R=new h(T[4],T[1],T[5],r);if(R.isClosing&&R.name==b.name){v.children.push(RegExp.leftContext.substring(f)),f=c.lastIndex;break}}else b.isSelfClosing||b.isNonClosing||(g.push(v),p=v)}}return t.htmlClean.trim(n(d,r).join(""))},t.htmlClean.defaults={bodyOnly:!0,allowedTags:[],removeTags:["basefont","center","dir","font","frame","frameset","iframe","isindex","menu","noframes","s","strike","u"],allowedAttributes:[],removeAttrs:[],allowedClasses:[],format:!1,formatIndent:0,replace:[[["b","big"],"strong"],[["i"],"em"]],replaceStyles:[[/font-weight:\s*bold/i,"strong"],[/font-style:\s*italic/i,"em"],[/vertical-align:\s*super/i,"sup"],[/vertical-align:\s*sub/i,"sub"]],allowComments:!1,allowEmpty:[]},t.htmlClean.trim=function(e){return t.htmlClean.trimStart(t.htmlClean.trimEnd(e))},t.htmlClean.trimStart=function(e){return e.substring(t.htmlClean.trimStartIndex(e))},t.htmlClean.trimStartIndex=function(e){for(var n=0;n<e.length-1&&t.htmlClean.isWhitespace(e.charAt(n));n++);return n},t.htmlClean.trimEnd=function(e){return e.substring(0,t.htmlClean.trimEndIndex(e))},t.htmlClean.trimEndIndex=function(e){for(var n=e.length-1;n>=0&&t.htmlClean.isWhitespace(e.charAt(n));n--);return n+1},t.htmlClean.isWhitespace=function(e){return-1!=t.inArray(e,I)};var p=["abbr","acronym","address","b","big","br","button","caption","cite","code","del","em","font","hr","i","input","img","ins","label","legend","map","q","s","samp","select","option","param","small","span","strike","strong","sub","sup","tt","u","var"],f=["address","button","caption","code","input","label","legend","select","option","param"],b=["h1","h2","h3","h4","h5","h6","p","th","td","object"],y=["th","td"],w=[null,"li",["ul","ol"],"dt",["dl"],"dd",["dl"],"td",["tr"],"th",["tr"],"tr",["table","thead","tbody","tfoot"],"thead",["table"],"tbody",["table"],"tfoot",["table"],"param",["object"]],A=["script","style","pre","code"],C=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],v=["!doctype","?xml"],x=[["class"],"?xml",[],"!doctype",[],"a",["accesskey","class","href","name","title","rel","rev","type","tabindex"],"abbr",["class","title"],"acronym",["class","title"],"blockquote",["cite","class"],"button",["class","disabled","name","type","value"],"del",["cite","class","datetime"],"form",["accept","action","class","enctype","method","name"],"iframe",["class","height","name","sandbox","seamless","src","srcdoc","width"],"input",["accept","accesskey","alt","checked","class","disabled","ismap","maxlength","name","size","readonly","src","tabindex","type","usemap","value"],"img",["alt","class","height","src","width"],"ins",["cite","class","datetime"],"label",["accesskey","class","for"],"legend",["accesskey","class"],"link",["href","rel","type"],"meta",["content","http-equiv","name","scheme","charset"],"map",["name"],"optgroup",["class","disabled","label"],"option",["class","disabled","label","selected","value"],"q",["class","cite"],"script",["src","type"],"select",["class","disabled","multiple","name","size","tabindex"],"style",["type"],"table",["class","summary"],"th",["class","colspan","rowspan"],"td",["class","colspan","rowspan"],"textarea",["accesskey","class","cols","disabled","name","readonly","rows","tabindex"],"param",["name","value"],"embed",["height","src","type","width"]],S=[[],"img",["alt"]],I=["Â "," ","	","\n","\r","\f"]}(jQuery);